.TH llapi_layout_file_open 3 "2013 Oct 31" "Lustre User API"
.SH NAME
llapi_layout_file_open \- open and apply a layout to a Lustre file
.SH SYNOPSIS
.nf
.B #include <lustre/lustreapi.h>
.PP
.BI "int llapi_layout_file_open(char *" path ", int " flags ", int " mode ,
.BI "                           const llapi_layout_t *" layout );
.fi
.SH DESCRIPTION
.LP
The function
.B llapi_layout_file_open()
open and possibly create a file at the given
.I path
with the permissions specified in
.I mode
using the Lustre layout attributes in
.IR layout .
The returned file descriptor may be used in subsequent system calls
.RB ( read (2),
.BR write (2),
.BR lseek (2),
etc.), and closed with
.BR close (2).
Zero or more file creation flags and file status flags can
be bitwise-or'd in
.IR flags .
Refer to
.BR open(2)
man page for a detailed description. This function will not succeed if the
.I path
is not on a Lustre filesystem.
.PP
.PP
The
.I layout
and
.I mode
will not be applied to a file which already exists.
.PP
A
.B NULL
.I layout
may be specified, in which case the standard Lustre behavior for
assigning layouts to newly-created files will apply.
.PP
If the pool name attribute of
.I layout
has been set, it must refer to an OST pool that exists and contains one
or more OSTs, otherwise these functions will fail and set
.B errno
to
.BR EINVAL .
See
.BR llapi_layout_pool_name_set (3).
.SH RETURN VALUES
.LP
.B llapi_layout_file_open()
return a new file descriptor, or -1 if an error occurred (in which
case, errno is set appropriately).
.SH ERRORS
.TP 15
.SM ENOTTY
.I path
does not reside on a Lustre filesystem.
.TP
.SM EINVAL
An invalid argument was specified.
.SH "SEE ALSO"
.BR llapi_layout (7),
.BR liblustreapi (7),
.BR llapi_layout_alloc (3),
.BR llapi_layout_pool_name_set (3),
.BR open (2),
.BR close (2)
